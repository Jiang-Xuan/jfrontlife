---
path: "/å‰åç«¯äº¤äº’è§„èŒƒ"
date: "2019-04-02"
title: "å‰åç«¯äº¤äº’è§„èŒƒ"
tags: ["è§„èŒƒ"]
---

## è¯·æ±‚æ–¹æ³•è§„èŒƒ

é‡‡ç”¨ REST è§„èŒƒ

* è·å–æ•°æ® `GET`
* ä¿®æ”¹æ•°æ® `POST`

## æ¥å£æ ¼å¼è§„èŒƒ

æ¥å£æ ¹å­—æ®µåŒ…å« `success<boolean>`, `code<number?>`, `message<string?>`, `data<{}>` å­—æ®µ

* success å­—æ®µè¡¨ç¤ºæ¥å£è¯·æ±‚çš„ä¸šåŠ¡åç«¯æ˜¯å¦å¤„ç†æˆåŠŸ
* code ä¸€ä¸ªçš„æ¥å£å“åº”ä¼šå‡ºç°å¤šåœºæ™¯, ç”¨è¯¥ code åŒºåˆ†å¤šåœºæ™¯, æ³¨æ„è¯¥ code å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—
* message è¡¨ç¤ºæ¥å£å“åº”å½“å‰çš„çŠ¶æ€ä¿¡æ¯, æç¤ºä¿¡æ¯
* data æ¥å£å“åº”çš„æ•°æ®, é»˜è®¤å¿…é¡»ä¸ºä¸€ä¸ªç©ºå¯¹è±¡, å³ä¾¿åœ¨é”™è¯¯çš„æƒ…å†µä¸‹ä¹Ÿéœ€è¦è¿”å›ä¸€ä¸ªç©ºå¯¹è±¡

### åˆ—è¡¨æ¥å£æ ¼å¼è§„èŒƒ

#### è¯·æ±‚è§„èŒƒ

**è¿™æ˜¯ä¸€ä¸ª `GET` è¯·æ±‚**

ä¸€ä¸ªè¡¨æ ¼çš„æ•°æ®å±•ç¤ºä¸€èˆ¬ä¼šæœ‰ç­›é€‰é¡¹çš„å‡ºç°, å¤æ‚çš„ç­›é€‰é¡¹ä¼šå¯¼è‡´è¯·æ±‚çš„å¤æ‚, æ‰€ä»¥å¿…é¡»æœ‰ä¸€ä¸ªè§„èŒƒæ¥çº¦æŸè¯·æ±‚çš„æ•°æ®æ ¼å¼

* è¡¨æ ¼çš„ç­›é€‰é¡¹ä¸€èˆ¬åˆ†ä¸º input ç­›é€‰, ä¹Ÿå°±æ˜¯æ–‡å­—ç­›é€‰

```text
drugName=foo&drugType=barbar
```

* å•é€‰é¡¹ç­›é€‰, radio å¼çš„ç­›é€‰, ä¸€èˆ¬ç”¨äºéæ˜¯å³å¦çš„é€‰é¡¹, ç¦æ­¢ä½¿ç”¨æ•°ç»„æ¥æäº¤å•é€‰é¡¹å¼çš„ç­›é€‰, å¦‚æœè€ƒè™‘åç»­æœ‰å¯èƒ½å‡çº§ä¸ºå¤šé€‰é¡¹å¼çš„ç­›é€‰, ä¹Ÿåº”è¯¥é‡æ–°è¯„ä¼°, ä¸éœ€è¦åšå‘åå…¼å®¹.

ç”±äº url å‚æ•°ä¸æ”¯æŒ Boolean, æ‰€ä»¥å­—ç¬¦ä¸² `'-1'` ä»£è¡¨ false, `'1'` ä»£è¡¨ true.

```text
// bad
hasFoo[0]='1'&hasBar[0]='-1'

// good
hasFoo='1'&hasBar='-1'
```

* å¤šé€‰é¡¹å¼ç­›é€‰, multiple radio å¼çš„ç­›é€‰, ä¸€èˆ¬ç”¨äºå¤šä¸ªé€‰é¡¹çš„ç­›é€‰, å¿…é¡»ç”¨æ•°ç»„è¿›è¡Œæäº¤, å³ä½¿ç›®å‰åªæœ‰ä¸€ä¸ªé€‰é¡¹

```text
drugType[0]='åŒ–è¯'&drugType[1]='ç”Ÿç‰©åˆ¶è¯'
```

* æ’åºå¼ç­›é€‰, æ’åºåˆ†ä¸ºé™åºæ’åº, å‡åºæ’åº

é™åºæ’åºä¸º -1 â–¼, å‡åºæ’åºä¸º 1 â–²

descend ä¸ºé™åº, ascend ä¸ºå‡åº

```text
sorter='id,descend'
```

å¤šé‡æ’åºå¼ç­›é€‰

```text
sorter='id,ascend;name,descend'
```

* æ—¶é—´å¼ç­›é€‰

æ—¶é—´ç­›é€‰ä¼ é€’æ—¶é—´æˆ³

å•ä¸ªæ—¶é—´ç­›é€‰

```text
inviteTime=1559788105474
```

æ—¶é—´æ®µç­›é€‰, ä¸é‡‡ç”¨æ•°ç»„ä¼ é€’, ä½¿ç”¨åç¼€ `start`, `end` æ¥æ ‡è¯†

```text
createTimeStart=1559788105474&createTimeEnd=1559788151853
```

* pagination å¼ç­›é€‰

åˆ—è¡¨çš„å½“å‰é¡µ, æ¯é¡µæ¡æ•°

```text
p=1&pageSize=15
```

#### å“åº”è§„èŒƒ

å¤§é‡çš„æ•°æ®, éœ€è¦ç¿»é¡µ

è¯¥è§„èŒƒåˆ†ä¸ºä¸¤ç§:

* ç”¨ head æ¥æ§åˆ¶æ•´ä¸ªè¡¨æ ¼çš„æ•°æ®å±•ç¤º

åœ¨è¡¨æ ¼çš„ç»“æ„ç”±æ¥å£æ§åˆ¶çš„æ—¶å€™å°¤ä¸ºæœ‰ç”¨, æ­¤æ—¶æ•°æ®çš„æ¸²æŸ“çš„ä¸»åŠ¨æƒæ˜¯ head å­—æ®µæ§åˆ¶.

æ¸²æŸ“æ•°æ®çš„æ–¹å¼ä¸ºéå† head å­—æ®µ, head å­—æ®µä¸ºä¸€ä¸ªæ•°ç»„, å†…éƒ¨çš„ å¯¹è±¡ ä¸­çš„ dataIndex æ¥æ ‡è¯†è¿™ä» list å†…éƒ¨çš„å¯¹è±¡ä¸­çš„å“ªä¸€ä¸ªå­—æ®µä¸­æ‹¿å–æ•°æ®

```typescript
interface IHead {
  name: string;
  dataIndex: string;
}
interface IList {
  // list æ•°æ®ä¸€èˆ¬éƒ½ä¼šéœ€è¦ id å­—æ®µ, å»ºè®®è¿”å›!!
  id: string;
  [string]: any;
}
interface IPagination {
  current: number;
  pageSize: number;
  total: number;
}

interface IData {
  head?: IHead[],
  // åˆ—è¡¨æ•°æ®
  list: IList[],
  // åˆ—è¡¨ç¿»é¡µæ•°æ®
  pagination: IPagination,
}

interface IResponse {
  // ä¸šåŠ¡æ˜¯å¦æˆåŠŸ
  success: boolean,
  // ä¸šåŠ¡ code
  code?: number,
  // æ¥å£ä¿¡æ¯
  message?: string,
  // ä¸šåŠ¡æ•°æ®
  data: IData,
}
```

* ç”¨ list æ¥æ§åˆ¶æ•´ä¸ªè¡¨æ ¼çš„æ•°æ®å±•ç¤º

æ¥å£çš„è¡¨æ ¼å¤´ä¸éœ€è¦æ¥å£æ¥æ§åˆ¶, è¡¨æ ¼çš„ç»“æ„æ˜¯ç”±å‰ç«¯æ¥å†™åœ¨ä»£ç ä¸­çš„, æ­¤æ—¶æ•°æ®çš„æ¸²æŸ“çš„ä¸»åŠ¨æƒåœ¨ å‰ç«¯

æ¸²æŸ“æ•°æ®çš„æ–¹å¼ä¸º, å‰ç«¯å†™å®šè¡¨æ ¼çš„ç»“æ„, ç„¶åä» list ä¸­æ‹¿å–å¯¹åº”çš„æ•°æ®, ä½†æ˜¯æ­¤æ—¶è¡¨æ ¼çš„å¤´éƒ¨æœ‰å¯èƒ½éœ€è¦ä¸€éƒ¨åˆ†çš„æ•°æ®ç”±æ¥å£è¿”å›, æ‰€ä»¥ head ä¸å†æ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹

```typescript
interface IHead {
  [string]: {
    filters: any
  };
}

interface IData {
  head?: IHead[],
  // åˆ—è¡¨æ•°æ®
  list: IList[],
  // åˆ—è¡¨ç¿»é¡µæ•°æ®
  pagination: IPagination,
}

interface IResponse {
  // ä¸šåŠ¡æ˜¯å¦æˆåŠŸ
  success: boolean,
  // ä¸šåŠ¡ code
  code?: number,
  // æ¥å£ä¿¡æ¯
  message?: string,
  // ä¸šåŠ¡æ•°æ®
  data: IData,
}
```

## æ¥å£å‘½åè§„èŒƒ

### å•ä¸ªåè¯æ¥å£

```shell
https://example.com/api/list
````

### å¤šä¸ªåè¯æ¥å£

- è¿å­—ç¬¦å‘½åæ³• (ğŸ‘ æœ€æ¨è)

```shell
https://example.com/api/foo-list
```

- é©¼å³°å¼å‘½åæ³• (ğŸ¤” å¯ä»¥æ¥å—)

```shell
https://example.com/api/fooList
```

- ä¸‹åˆ’çº¿å¼å‘½åæ³• (ğŸ˜” ä¸æ¨è)

```shell
  https://example.com/api/foo_list
```
